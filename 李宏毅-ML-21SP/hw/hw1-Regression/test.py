import csv
import numpy as np
import pandas as pd

path = './covid.train.csv'

with open(path, 'r') as fp:

    data = list(csv.reader(fp))
    print(data[0])
    cls = data[0][1:]


    for i in range(len(cls)):
        if i < 40:
            print(i, '\t', cls[i], end='\t')
            if i % 10 == 0:
                print(' ')
        else:
            if i % 5 == 0:
                print(' ')
            print(i, '\t', cls[i], end='\t')

    data = np.array(data[1:])[:, 1:].astype(float)
    allData = data
    data = data[:, 0:-1]

    positive = data[:, -1]
    print('\n positive: ', positive, '\n')

    row, col = data.shape
    print(row, col)
    ls = []
    #
    # for j in range(40, col):
    #     avg = 0
    #     total = 0
    #     for i in range(row):
    #         total += data[i, j]
    #     avg = total / row
    #     s2 = 0
    #     for i in range(row):
    #         s2 += (data[i, j] - avg) ** 2
    #     s2 /= row
    #
    #     print(j, '   ', s2)
    #
    #     ls.append((j, s2))

    count = 0
    for k in ls:

        if k[1] >= 35:
            print(k[0], end=', ')
            count += 1
    print(' ')
    print(count)

    ls10 = [42, 43, 44, 45, 46, 47, 48, 49, 50, 55, 56, 57, 60, 61, 62, 63, 64, 65, 66, 67, 68, 73, 74, 75, 78, 79, 80, 81, 82, 83, 84, 85, 86, 91, 92]
    ls15 = [42, 43, 44, 46, 47, 48, 49, 50, 55, 56, 57, 60, 61, 62, 64, 65, 66, 67, 68, 73, 74, 75, 78, 79, 80, 82, 83, 84, 85, 86, 91, 92]
    ls20 = [42, 43, 44, 46, 47, 48, 49, 50, 55, 56, 57, 60, 61, 62, 64, 65, 66, 67, 68, 73, 74, 75, 78, 79, 80, 82, 83, 84, 85, 86, 91, 92]
    ls25 = [42, 43, 44, 48, 49, 55, 56, 57, 60, 61, 62, 66, 67, 73, 74, 75, 78, 79, 80, 84, 85, 91, 92]
    ls30 = [42, 43, 48, 49, 55, 57, 60, 61, 66, 67, 73, 75, 78, 79, 84, 85, 91]
    ls35 = [42, 43, 49, 55, 57, 60, 61, 67, 73, 75, 78, 79, 85, 91]
    ls40 = [42, 43, 49, 57, 60, 61, 67, 75, 78, 79, 85]

    ls = [ls10, ls15, ls20, ls25, ls30, ls35, ls40]

    # for i in ls:
    #
    #     for j in i:
    #         print(cls[j], end=', ')
    #
    #     print()
        
    # tag = ['cli', 'ili', 'hh_cmnty_cli', 'nohh_cmnty_cli', 'wearing_mask', 'travel_outside_state', 'work_outside_home', 'public_transit',
    #        ]

    df = pd.DataFrame(allData[:, 40:], columns=cls[40:])
    print(type(df), df.shape)
    # corr_pearson = df.corr(method='pearson')
    corr_spearman = df.corr(method='spearman')
    corr_kendall = df.corr(method='kendall')

    # print('\nPearson:  ')
    # print(corr_pearson, '\n')

    print(type(corr_spearman))
    print('\nSpearmon:  ')
    print(corr_spearman, '\n')
    corr_s = corr_spearman.iloc[-1]

    print(type(corr_kendall))
    print('\nKendall:  ')
    print(corr_kendall, '\n')
    corr_k = corr_kendall.iloc[-1]

    pd.set_option('display.width', 300)  # 设置字符显示宽度
    pd.set_option('display.max_rows', None)  # 设置显示最大行
    pd.set_option('display.max_columns', None)  # 设置显示最大列，None为显示所有列

    # print(type(corr_s))
    # sort_s = corr_s.sort_values(ascending=False)
    # print(sort_s)
    # index_s = list(sort_s.index)
    # del_re_s = []
    # for i in index_s:
    #     if i not in del_re_s:
    #         del_re_s.append(i)
    # print(del_re_s)

    print('---------------------------------------------------------------')

    rate = 0.45

    list_s = list(corr_s)[:-1]


    
    list_k = list(corr_k)[:-1]

    Rate = [0.1, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.66, 0.67, 0.68, 0.69, 0.7, 0.8, 0.825, 0.85, 0.875, 0.9, 0.95]
    
    for rate in Rate:
        print(' #  Rate = ', rate)
        
        s_choose = []
        for i in range(len(list_s)):
            if abs(list_s[i]) > rate:
                s_choose.append(i+40)
        print('s_choose = ', s_choose, ' # ', len(s_choose))

        both = s_choose

        k_choose = []
        for i in range(len(list_k)):
            if abs(list_k[i]) > rate:
                k_choose.append(i+40)
                if i+40 not in both:
                    both.append(i+40)
        print('k_choose = ', k_choose, ' # ', len(k_choose))
        
        print('Both     = ', both, '   # ', len(both))
        
        
        print()

    l1 = [[1, 2, 3, 4], [2, 3, 4, 5], [1, 8, 9, 10]]
    l2 = [[778, 99, 10, 21], [110, 112, 114, 119]]

    print(l1[0:2])
    print(l2)
    print(l1+l2)

#  #  Rate =  0.1
# s_choose =  [40, 41, 42, 43, 47, 48, 49, 51, 52, 54, 55, 56, 57, 58, 59, 60, 61, 65, 66, 67, 69, 70, 72, 73, 74, 75, 76, 77, 78, 79, 83, 84, 85, 87, 88, 90, 91, 92]  #  38
# k_choose =  [40, 41, 42, 43, 47, 48, 49, 51, 52, 54, 55, 56, 57, 58, 59, 60, 61, 65, 66, 67, 69, 70, 72, 73, 74, 75, 76, 77, 78, 79, 83, 84, 85, 87, 90, 91, 92]  #  37
# Both     =  [40, 41, 42, 43, 47, 48, 49, 51, 52, 54, 55, 56, 57, 58, 59, 60, 61, 65, 66, 67, 69, 70, 72, 73, 74, 75, 76, 77, 78, 79, 83, 84, 85, 87, 88, 90, 91, 92]    #  38
#
#  #  Rate =  0.2
# s_choose =  [40, 41, 42, 43, 47, 48, 49, 51, 55, 56, 57, 58, 59, 60, 61, 65, 66, 67, 69, 73, 74, 75, 76, 77, 78, 79, 83, 84, 85, 87, 91, 92]  #  32
# k_choose =  [40, 41, 42, 43, 47, 51, 56, 57, 58, 59, 60, 61, 65, 69, 74, 75, 76, 77, 78, 79, 83, 87, 92]  #  23
# Both     =  [40, 41, 42, 43, 47, 48, 49, 51, 55, 56, 57, 58, 59, 60, 61, 65, 66, 67, 69, 73, 74, 75, 76, 77, 78, 79, 83, 84, 85, 87, 91, 92]    #  32
#
#  #  Rate =  0.25
# s_choose =  [40, 41, 42, 43, 47, 49, 51, 55, 56, 57, 58, 59, 60, 61, 65, 67, 69, 73, 74, 75, 76, 77, 78, 79, 83, 85, 87, 91, 92]  #  29
# k_choose =  [40, 41, 42, 43, 47, 51, 56, 57, 58, 59, 60, 61, 65, 69, 74, 75, 76, 77, 78, 79, 83, 87, 92]  #  23
# Both     =  [40, 41, 42, 43, 47, 49, 51, 55, 56, 57, 58, 59, 60, 61, 65, 67, 69, 73, 74, 75, 76, 77, 78, 79, 83, 85, 87, 91, 92]    #  29
#
#  #  Rate =  0.3
# s_choose =  [40, 41, 42, 43, 47, 51, 56, 57, 58, 59, 60, 61, 65, 69, 74, 75, 76, 77, 78, 79, 83, 87, 92]  #  23
# k_choose =  [40, 41, 42, 43, 51, 56, 57, 58, 59, 60, 61, 69, 74, 75, 76, 77, 78, 79, 87, 92]  #  20
# Both     =  [40, 41, 42, 43, 47, 51, 56, 57, 58, 59, 60, 61, 65, 69, 74, 75, 76, 77, 78, 79, 83, 87, 92]    #  23
#
#  #  Rate =  0.35
# s_choose =  [40, 41, 42, 43, 47, 51, 56, 57, 58, 59, 60, 61, 65, 69, 74, 75, 76, 77, 78, 79, 83, 87, 92]  #  23
# k_choose =  [40, 41, 42, 43, 51, 57, 58, 59, 60, 61, 69, 75, 76, 77, 78, 79, 87]  #  17
# Both     =  [40, 41, 42, 43, 47, 51, 56, 57, 58, 59, 60, 61, 65, 69, 74, 75, 76, 77, 78, 79, 83, 87, 92]    #  23
#
#  #  Rate =  0.4
# s_choose =  [40, 41, 42, 43, 47, 51, 56, 57, 58, 59, 60, 61, 65, 69, 74, 75, 76, 77, 78, 79, 83, 87, 92]  #  23
# k_choose =  [40, 41, 42, 43, 57, 58, 59, 60, 61, 75, 76, 77, 78, 79]  #  14
# Both     =  [40, 41, 42, 43, 47, 51, 56, 57, 58, 59, 60, 61, 65, 69, 74, 75, 76, 77, 78, 79, 83, 87, 92]    #  23
#
#  #  Rate =  0.45
# s_choose =  [40, 41, 42, 43, 51, 56, 57, 58, 59, 60, 61, 69, 74, 75, 76, 77, 78, 79, 87, 92]  #  20
# k_choose =  [40, 41, 42, 43, 57, 58, 59, 60, 61, 75, 76, 77, 78, 79]  #  14
# Both     =  [40, 41, 42, 43, 51, 56, 57, 58, 59, 60, 61, 69, 74, 75, 76, 77, 78, 79, 87, 92]    #  20
#
#  #  Rate =  0.5
# s_choose =  [40, 41, 42, 43, 51, 57, 58, 59, 60, 61, 69, 75, 76, 77, 78, 79, 87, 92]  #  18
# k_choose =  [40, 41, 42, 43, 57, 58, 59, 60, 61, 75, 76, 77, 78, 79]  #  14
# Both     =  [40, 41, 42, 43, 51, 57, 58, 59, 60, 61, 69, 75, 76, 77, 78, 79, 87, 92]    #  18
#
#  #  Rate =  0.55
# s_choose =  [40, 41, 42, 43, 51, 57, 58, 59, 60, 61, 69, 75, 76, 77, 78, 79, 87]  #  17
# k_choose =  [40, 41, 42, 43, 57, 58, 59, 60, 61, 75, 76, 77, 78, 79]  #  14
# Both     =  [40, 41, 42, 43, 51, 57, 58, 59, 60, 61, 69, 75, 76, 77, 78, 79, 87]    #  17
#
#  #  Rate =  0.6
# s_choose =  [40, 41, 42, 43, 57, 58, 59, 60, 61, 75, 76, 77, 78, 79]  #  14
# k_choose =  [40, 41, 42, 43, 57, 58, 59, 60, 61, 75, 76, 77, 78, 79]  #  14
# Both     =  [40, 41, 42, 43, 57, 58, 59, 60, 61, 75, 76, 77, 78, 79]    #  14
#
#  #  Rate =  0.7
# s_choose =  [40, 41, 42, 43, 57, 58, 59, 60, 61, 75, 76, 77, 78, 79]  #  14
# k_choose =  [42, 57, 60, 75, 78]  #  5
# Both     =  [40, 41, 42, 43, 57, 58, 59, 60, 61, 75, 76, 77, 78, 79]    #  14
#
#  #  Rate =  0.8
# s_choose =  [40, 41, 42, 43, 57, 58, 59, 60, 61, 75, 76, 77, 78, 79]  #  14
# k_choose =  [57, 75]  #  2
# Both     =  [40, 41, 42, 43, 57, 58, 59, 60, 61, 75, 76, 77, 78, 79]    #  14
#


    # id = [40, 41, 42, 43, 46, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 64, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 82, 88, 89, 90, 91, 92, 93]
